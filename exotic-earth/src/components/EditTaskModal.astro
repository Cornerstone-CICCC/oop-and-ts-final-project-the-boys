---
const { 
  id, 
  taskTitle = "CSS Grid Layout", 
  taskId = "TK-1024",
  createdBy = "Sarah Chen",
  status = "In Progress",
  priority = "High",
  dueDate = "Oct 24, 2023",
  description = "Implement the main dashboard using CSS grid layout..." 
} = Astro.props;
---

<dialog id={id} class="task-modal">
  <div class="modal-wrapper">
    <header class="modal-header">
      <div class="header-left">
        <div class="icon-container">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
        </div>
        <span class="breadcrumb">TASK DETAILS</span>
      </div>
      <div class="header-right">
        <button class="icon-btn" title="Edit"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button>
        <button class="icon-btn hover-red" title="Delete"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
        <div class="v-divider"></div>
        <button class="icon-btn close-trigger" onclick={`this.closest('dialog').close()`}>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
    </header>

    <div class="modal-body">
      <section class="title-area">
        <h1>{taskTitle}</h1>
        <p>Task ID: <span class="text-blue">{taskId}</span> • Created by {createdBy}</p>
      </section>

      <div class="info-grid">
        <div class="info-item">
          <label>STATUS</label>
          <div class="badge status">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            {status}
          </div>
        </div>
        <div class="info-item">
          <label>PRIORITY</label>
          <div class="badge priority">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
            {priority}
          </div>
        </div>
        <div class="info-item">
          <label>DUE DATE</label>
          <div class="badge date">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            {dueDate}
          </div>
        </div>
      </div>

      <section class="desc-section">
        <h3><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> Description</h3>
        <div class="desc-box">
          <p>{description}</p>
        </div>
      </section>

      <section class="team-section">
        <h3><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> Assigned Team</h3>
        <div class="avatar-group">
          <img src="https://i.pravatar.cc/100?u=1" alt="User" />
          <img src="https://i.pravatar.cc/100?u=2" alt="User" />
          <img src="https://i.pravatar.cc/100?u=3" alt="User" />
          <div class="avatar-more">+2</div>
        </div>
      </section>
    </div>

    <footer class="modal-footer">
      <button class="btn-cancel" onclick={`this.closest('dialog').close()`}>Close</button>
      <button class="btn-save" data-save-for={id}>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
        Mark as Complete
      </button>
    </footer>
  </div>
</dialog>

<style>
  /* Variáveis de cores baseadas no Dark Mode do Tailwind */
  :root {
    --bg-dark: #16222c;
    --bg-overlay: rgba(2, 6, 23, 0.6);
    --border-color: #334155;
    --text-main: #ffffff;
    --text-muted: #94a3b8;
    --primary: #3b82f6;
    --primary-soft: rgba(59, 130, 246, 0.1);
    --danger-soft: rgba(239, 68, 68, 0.1);
    --danger: #ef4444;
  }

  /* Reset e Animações do Dialog */
  dialog {
    padding: 0;
    border: none;
    background: transparent;
    max-width: 650px;
    width: 95%;
    border-radius: 12px;
    color: var(--text-main);
    font-family: system-ui, -apple-system, sans-serif;
  }

  dialog::backdrop {
    background: var(--bg-overlay);
    backdrop-filter: blur(4px);
    animation: fadeIn 0.3s ease-out;
  }

  dialog[open] .modal-wrapper {
    animation: modalIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(20px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }

  .modal-wrapper {
    background: var(--bg-dark);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    overflow: hidden;
  }


  .icon-container { background: var(--primary-soft); padding: 0.4rem; border-radius: 8px; display: flex; }
  .breadcrumb { font-size: 0.7rem; font-weight: 800; letter-spacing: 0.1em; color: var(--text-muted); text-transform: uppercase; }

  .header-right { display: flex; align-items: center; gap: 0.5rem; }
  .icon-btn { background: transparent; border: none; color: var(--text-muted); padding: 0.5rem; cursor: pointer; border-radius: 8px; transition: 0.2s; display: flex; }
  .icon-btn:hover { background: #1e293b; color: var(--text-main); }
  .icon-btn.hover-red:hover { background: var(--danger-soft); color: var(--danger); }
  .v-divider { width: 1px; height: 24px; background: var(--border-color); margin: 0 0.5rem; }

  /* Body */
  .modal-body { padding: 2rem; }
  .title-area h1 { font-size: 1.8rem; font-weight: 800; margin: 0 0 0.5rem 0; letter-spacing: -0.02em; }
  .title-area p { font-size: 0.875rem; color: var(--text-muted); font-weight: 500; }
  .text-blue { color: var(--primary); }

  .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin: 2rem 0; }
  .info-item label { display: block; font-size: 0.65rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; letter-spacing: 0.05em; }
  
  .badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0.8rem; border-radius: 8px; font-size: 0.8rem; font-weight: 700; border: 1px solid transparent; }
  .badge.status { background: var(--primary-soft); color: var(--primary); border-color: rgba(59, 130, 246, 0.2); }
  .badge.priority { background: var(--danger-soft); color: var(--danger); border-color: rgba(239, 68, 68, 0.2); }
  .badge.date { background: #1e293b; color: #cbd5e1; border-color: var(--border-color); }

  .desc-section h3, .team-section h3 { font-size: 0.875rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem; color: #e2e8f0; }
  .desc-box { background: rgba(30, 41, 59, 0.5); padding: 1.25rem; border-radius: 12px; border: 1px solid #1e293b; line-height: 1.6; color: #cbd5e1; }

  .team-section { margin-top: 2rem; }
  .avatar-group { display: flex; align-items: center; }
  .avatar-group img, .avatar-more { 
    width: 40px; height: 40px; border-radius: 50%; border: 3px solid var(--bg-dark); margin-left: -12px; object-cover: cover;
  }
  .avatar-group img:first-child { margin-left: 0; }
  .avatar-more { background: #1e293b; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; color: var(--text-muted); }


  .btn-cancel { background: transparent; border: none; color: #cbd5e1; font-weight: 700; font-size: 0.875rem; cursor: pointer; padding: 0.6rem 1.2rem; border-radius: 8px; transition: 0.2s; }
  .btn-cancel:hover { background: #334155; }

  .btn-save {
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.65rem 1.5rem;
    border-radius: 8px;
    font-weight: 700;
    font-size: 0.875rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3);
    transition: 0.2s;
  }
  .btn-save:hover { transform: translateY(-1px); background: #2563eb; }
</style>